<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Data Vault Showcase</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .table-container {
            height: 280px; /* Fixed height for the table containers */
            overflow-y: auto;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 flex">

    <!-- Navigation Rail -->
    <aside class="w-20 md:w-64 bg-white shadow-md flex-shrink-0">
        <div class="p-4 border-b">
            <h2 class="text-xl font-bold text-indigo-700 hidden md:block">Use Cases</h2>
            <h2 class="text-xl font-bold text-indigo-700 text-center md:hidden">PDV</h2>
        </div>
        <nav class="p-2 space-y-2">
            <a href="#" class="flex items-center p-3 rounded-lg bg-indigo-100 text-indigo-700 font-semibold">
                <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                <span class="hidden md:block">Checkout Demo</span>
            </a>
            <a href="#" class="flex items-center p-3 rounded-lg text-gray-600 hover:bg-gray-200">
                 <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                <span class="hidden md:block">Profile Management</span>
            </a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="flex-1">
        <div class="container mx-auto p-4 md:p-8">
            <header class="text-center mb-10">
                <h1 class="text-4xl font-bold text-gray-900">Personal Data Vault</h1>
                <p class="text-lg text-gray-600 mt-2">Demonstrating Secure PII Tokenization</p>
            </header>

            <div class="flex flex-col md:flex-row gap-8">
                
                <!-- Left Column: Use Case Panel -->
                <div class="w-full md:w-1/2 bg-white p-6 rounded-xl shadow-lg">
                    <h2 class="text-2xl font-semibold mb-6 text-center border-b pb-4">Checkout Demo</h2>
                    
                    <!-- Account Selector -->
                    <div class="mb-6">
                        <label for="account-selector" class="block text-sm font-medium text-gray-700 mb-2">Select Store (Account):</label>
                        <select id="account-selector" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                            <option value="FashionA">FashionA</option>
                            <option value="FashionB">FashionB</option>
                        </select>
                    </div>

                    <!-- Product Listing -->
                    <div class="mb-6 border-t border-b py-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Your Cart</h3>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">White T-Shirt</span>
                                <span class="font-medium">$25.00</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">Pair of Socks</span>
                                <span class="font-medium">$8.00</span>
                            </div>
                        </div>
                    </div>

                    <form id="checkout-form" class="space-y-6">
                        <div>
                            <label for="name" class="block text-sm font-medium text-gray-700">Full Name</label>
                            <input type="text" id="name" name="name" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" placeholder="Jane Doe" required>
                        </div>
                        <div>
                            <label for="email" class="block text-sm font-medium text-gray-700">Email Address</label>
                            <input type="email" id="email" name="email" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" placeholder="jane.doe@example.com" required>
                        </div>
                        <div>
                            <label for="address" class="block text-sm font-medium text-gray-700">Shipping Address</label>
                            <input type="text" id="address" name="address" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" placeholder="123 Main St, Anytown, USA" required>
                        </div>
                        <div>
                            <label for="credit-card" class="block text-sm font-medium text-gray-700">Credit Card Number</label>
                            <input type="text" id="credit-card" name="credit-card" class="mt-1 block w-full px-3 py-2 bg-gray-200 border border-gray-300 rounded-md shadow-sm" value="**** **** **** 4242" disabled>
                        </div>
                        <div class="border-t pt-6">
                            <div class="flex justify-between items-center text-lg font-semibold">
                                <span>Total Price:</span>
                                <span>$33.00</span>
                            </div>
                        </div>
                        <button type="submit" class="w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out">
                            Complete Purchase
                        </button>
                    </form>
                </div>

                <!-- Right Column: Data Visualization -->
                <div class="w-full md:w-1/2 bg-white p-6 rounded-xl shadow-lg">
                    <h2 class="text-2xl font-semibold mb-4 text-center border-b pb-4">Data Flow Visualization</h2>
                    
                    <!-- Personal Data Vault Table -->
                    <div class="mb-8">
                        <h3 class="text-xl font-semibold mb-3 text-indigo-700">1. Personal Data Vault</h3>
                        <p class="text-sm text-gray-600 mb-3">Securely stores a map of raw PII to a generated token. Access is highly restricted.</p>
                        <div class="table-container border border-gray-200 rounded-lg">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50 sticky top-0">
                                    <tr>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Store</th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Data Subject</th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Raw Data</th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Generated Token</th>
                                    </tr>
                                </thead>
                                <tbody id="vault-db" class="bg-white divide-y divide-gray-200">
                                    <!-- Vault data will be injected here -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Orders Database Table -->
                    <div>
                        <h3 class="text-xl font-semibold mb-3 text-teal-700">2. Orders Database</h3>
                        <p class="text-sm text-gray-600 mb-3">Stores order information using tokens instead of raw PII, minimizing data exposure.</p>
                         <div class="table-container border border-gray-200 rounded-lg">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50 sticky top-0">
                                    <tr>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Order ID</th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Store</th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Items</th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ship to Address</th>
                                    </tr>
                                </thead>
                                <tbody id="orders-db" class="bg-white divide-y divide-gray-200">
                                    <!-- Orders data will be injected here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <script>
        // --- DOM Element Selection ---
        const checkoutForm = document.getElementById('checkout-form');
        const vaultDbBody = document.getElementById('vault-db');
        const ordersDbBody = document.getElementById('orders-db');
        const accountSelector = document.getElementById('account-selector');

        // --- Event Listener for Form Submission ---
        checkoutForm.addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent the default form submission

            // --- 1. Get Context and User Input ---
            const account = accountSelector.value;
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value; // This is our Data Subject
            const address = document.getElementById('address').value;

            // Simple validation
            if (!name || !email || !address) {
                console.error("Please fill out all fields.");
                return; 
            }

            // --- 2. Simulate Context-Aware Tokenization ---
            const nameToken = generateSimpleHash(name, email, account);
            const emailToken = generateSimpleHash(email, email, account);
            const addressToken = generateSimpleHash(address, email, account);

            // --- 3. Update the Personal Data Vault Table ---
            addVaultRow(account, email, name, nameToken);
            addVaultRow(account, email, email, emailToken);
            addVaultRow(account, email, address, addressToken);

            // --- 4. Update the Orders Database Table ---
            const orderId = `ORD-${Date.now().toString().slice(-6)}`;
            const itemIds = ['t-shirt-white', 'socks-pair'];

            const newOrderRow = document.createElement('tr');
            newOrderRow.innerHTML = `
                <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">${orderId}</td>
                <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">${account}</td>
                <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">${itemIds.join(', ')}</td>
                <td class="px-4 py-3 whitespace-nowrap text-sm text-green-600 font-mono">${nameToken}</td>
                <td class="px-4 py-3 whitespace-nowrap text-sm text-green-600 font-mono">${emailToken}</td>
                <td class="px-4 py-3 whitespace-nowrap text-sm text-green-600 font-mono">${addressToken}</td>
            `;
            ordersDbBody.appendChild(newOrderRow);
            
            // Animate the new row
            newOrderRow.classList.add('animate-pulse');
            setTimeout(() => newOrderRow.classList.remove('animate-pulse'), 1500);

            // --- 5. Reset the Form ---
            checkoutForm.reset();
        });

        /**
         * Helper function to add a new row to the Vault table.
         * @param {string} account - The context of the operation (e.g., store name).
         * @param {string} dataSubject - The identifier for the data owner (e.g., email).
         * @param {string} rawData - The original, sensitive data.
         * @param {string} token - The generated token.
         */
        function addVaultRow(account, dataSubject, rawData, token) {
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">${account}</td>
                <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">${dataSubject}</td>
                <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">${rawData}</td>
                <td class="px-4 py-3 whitespace-nowrap text-sm text-red-600 font-mono">${token}</td>
            `;
            vaultDbBody.appendChild(newRow);
            
            newRow.classList.add('animate-pulse');
            setTimeout(() => newRow.classList.remove('animate-pulse'), 1500);
        }

        /**
         * Generates a simple, non-secure hash from a string and its context.
         * The function now adds the 'pdv_' prefix internally.
         * @param {string} str - The input string (the raw PII).
         * @param {string} dataSubject - The identifier for the data owner (e.g., email).
         * @param {string} account - The context of the operation (e.g., store name).
         * @returns {string} A short hash-like string with a 'pdv_' prefix.
         */
        function generateSimpleHash(str, dataSubject, account) {
            // Combine the raw data with its context to create a unique input for the hash.
            const combinedString = `${str}::${dataSubject}::${account}`;
            
            let hash = 0;
            for (let i = 0; i < combinedString.length; i++) {
                const char = combinedString.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash |= 0; // Convert to 32bit integer
            }
            const hashValue = Math.abs(hash).toString(16).slice(0, 8);
            return `pdv_${hashValue}`;
        }
    </script>
</body>
</html>
